# Надстройка для Excel "URALTEST ADDIN"

**Описание проекта** Надстройка добавляет в ribbon-панель Excel кнопки, функционал которых позволяет решать 2 основные задачи:
1. упрощение процессов создания и ведения протоколов измерений;
2. автоматизация процесса взаимодействия с измерительным оборудованием.

## Упрощение процессов создания и ведения протоколов измерений

В 1 версии URALTEST ADDIN множество протоколов измерений были объединены в один файл, что позволяло экономить время на разработке частей, общих для разных протоколов - при выборе конкретного средства измерений и его комплектации лишние части файла удалялись.

2 версия URALTEST ADDIN поддерживает работу с протоколами версии 1, плюс, поддерживает новый формат: файл протокола должен содержать лист PropsOut с командами, которые обрабатываются надстройкой. Команды позволяют добавлять в файл информацию из сторонних источников (файлов-хранилищ), содержат информацию о пути к папкам с протоколами/документацией и ПО прибора, другие процедуры.

## Автоматизация процесса взаимодействия с измерительным оборудованием

Во-первых, надстройка позволяет считывать команды управления, записанные в ячейки протокола измерений в определенном формате, преобразовывать их в формат, понятный управляемому оборудованию, отправлять команды в подключенное к компьютеру измерительное оборудование:
* калибратор универсальный Н4-11;
* калибратор универсальный Н4-17;
* источник тока АКИП 1135.

Во-вторых, надстройка содержит формы, которые позволяют управлять с помощью кнопок на этих формах подключенным измерительным оборудованием:
* генератор сигналов произвольной формы Agilent 33220A;
* мультиметр цифровой Agilent 34410A;
* осциллограф Metrix OX7042;
* измеритель напряженности электрического и магнитного полей BE-метр (модификации "АТ-004" и "50 Гц");
* измеритель электростатического поля ИПЭП-1.

## Ограничения
Надстройка запускается только на компьютерах ФБУ "УРАЛТЕСТ".


## История изменений

|Версия	|	Дата	|	Изменения|
|-|-|-|
|	0.9	|	14.03.2017	|	Прототип	|
|	1.0	|	10.04.2017	|	Выделил макросы из общего файла "Формы протоколов"	|
|	1.1	|	02.06.2017	|	Добавлен "Считыватель команд управления"	|
|	1.1a	|	20.04.2017	|		|
|	1.1b	|	11.05.2017	|		|
|	1.1c	|	19.05.2017	|		|
|	1.1d	|	23.05.2017	|		|
|	1.1e	|	24.05.2017	|		|
|	1.1f	|	27.05.2017	|		|
|	1.1g	|	29.05.2017	|		|
|	1.1h	|	02.06.2017	|		|
|	1.1j	|	02.06.2017	|		|
|	1.2	|	05.06.2017	|	Исправлены ошибки, у msgbox при смене режима работы Н4-17 появилась кнопка отмена	|
|	1.3	|	07.06.2017	|	Исправил ошибки	|
|	1.4	|	10.06.2017	|	Исправил ошибки	|
|	1.5	|	20.06.2017	|	Начал работу по управлению 33220a и 34410a	|
|	1.6	|	29.06.2017	|		|
|	1.6a	|	09.07.2017	|		|
|	1.7a	|	10.07.2017	|		|
|	1.7b	|	06.10.2017	|		|
|	1.8a	|	29.10.2017	|		|
|	1.8a final	|	16.11.2020	|	Изменен путь к db.xlsb для большего единообразия системы папок протоколов 1.0 и 2.0. Завершение развития ветки	|
|	1.8b	|	11.01.2020	|	Добавил панель управления осциллографом OX7042	|
|	1.8c	|	13.01.2020	|	Добавил панель управления мультиметром 34410 (2 шт.) Есть проблемы. Главная - совсем не получилось реализовать измерения переменки с полосой пропускания от 3 Гц (только от 20 Гц). Можно жестко включить какой-либо режим работы фильтра, но при измерении с компа он сбрасывается на 20 Гц. Аналогичная проблема с NPLC и постоянкой - не понял, как увязать числовые значения и режим AUTO, поэтому реализовал только 3 режима: Min Def и Max, что уже неплохо	|
|	1.8d	|	15.01.2020	|	Добавил панель управления генератором 33220	|
|	1.8e	|	04.03.2020	|	Добавил панель управления BE-метр АТ-004	|
|	1.8f	|	18.03.2020	|		|
|	1.8g	|	28.04.2020	|	Доработал панель управления BE-метр АТ-004	|
|	2.0	|	2018-2019	|	Вел разработку ответвления "Протоколы 2.0"	|
|	 	|	01.05.2020	|	Собрал в одну надстройку наработки версии 1 (вариант 1.8g) и наработки по проекту "Протоколы 2.0 Из проекта "Протоколы 2.0 исключил командную строку - сложно, нет смысла, ведение log-ов - сложно, пока нет смысла, разделение на client и main с нормальной системой обновления основного тела программы - сложно, пока нет смысла. Данные возможности можно реализовать в будущем, пока упор на то, чтобы перейти от хранения протоколов в одном файле (Формы протоколов.xlsb) к расширению функционала надстройки (Протоколы 2.0)"	|
|	 	|	07.05.2020	|	Исправление мелких багов + переписал механизм проверки наличия/создания папки при отсутствии	|
|	 	|	08.05.2020	|	Исправление ошибок	|
|	 	|	11.05.2020	|	Добавил форму панели управления ИПЭП-1	|
|	 	|	14.05.2020	|	"Отладил панель управления ИПЭП-1, вынес на ленту. Уменьшил размеры панелей управления для удобства работы на малом экране"	|
|	 	|	15.05.2020	|	Из листа идеи_баги_фичи выделил лист Идеи и лист Баги для порядка	|
|	 	|		|	Увеличил количество портов с 16 до 64 - посмотрим, как будет работать (для BE-метров must have)	|
|	 	|		|	Видит по-факту 9 - проверял, подключая ВЕ-метр и OX7042	|
|	 	|	21.05.2020	|	Перенес идеи внешнего вида Считывателя команд 2 в Считыватель команд в примерном виде, удалил Считыватель команд 2	|
|	 	|	12.07.2020	|	Из-за проблемы с использованием штатного Bluetooth ноутбука необходимо использовать модуль, присланный НТМ-Защита при поверке ВЕ-метр. Для этого внес изменения в панель управления ВЕ-метром	|
|	 	|	17.07.2020	|	Добавил LAN-адреса	|
|	 	|		|	Изменил работу кнопок В окно/В ячейку	|
|	 	|	24.07.2020	|	На панели управления BE-метрами при подключении прибора скрываются лишние вкладки	|
|	 	|	10.09.2020	|	Исправил ошибку подключения ВЕ-метр модификации 50 Гц с "#" перед номером в ответе на запрос	|
|	 	|	18.09.2020	|	В панели управления ВЕ-метр измерение НМП выполняется отправкой 2 команд.	|
|	 	|	22.10.2020	|	Исправил работу формы Управление данными 1. Исправлена ошибка в объявлении переменной пути к db.xlsb.	|
|	 	|	26.10.2020	|	Исправление мелкой ошибки	|
|	 	|	20.11.2020	|	Исправил ошибку в алгоритме ручного сохранения файла.	|
|	 	|	26.11.2020	|	Объединил две формы мультиметра в одно	|
|	 	|		|	Добавил функцию синхронного запуска измерений	|
|	 	|		|	Исправил ошибку неправильного пути к db.xlsb в форме работы с листами года выпуска	|
|	 	|	27.11.2020	|	Проверил вчерашние изменения - измерения в "синхронном" режиме выполняются одно за другим - есть задержка	|
|	 	|		|	Исправил еще одну ошибку неправильного пути к db.xlsb на форме работы с листами года выпуска	|
|	 	|	17.12.2020	|	Удалил reference, вызывающий ошибку в Office 2019	|
|	 	|	17.07.2021	|	Добавил разрешение для своего личного компьютера	|
|	 	|	09.03.2022	|		|
|	 	|	17.05.2022	|	Доп функции OX7042	|
|	 	|	06.06.2022	|	Добавил возможность подключения новых ВЕ-метров модификации 50 Гц	|
